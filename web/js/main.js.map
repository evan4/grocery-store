{"version":3,"sources":["../../assets/js/es6/main.js"],"names":["jQuery","document","ready","$","click","event","preventDefault","animate","scrollTop","hash","offset","top","navoffeset","window","scroll","scrollpos","addClass","removeClass","hover","stop","slideDown","toggleClass","slideUp","UItoTop","easingType","flexslider","animation","start","slider","okzoom","width","height","border","shadow","on","e","id","data","ajax","url","done","res","alert","updateCartDialog","fail","error","console","log","$modal","find","index","closest","deleteItem","then","length","removeUtemFromTable","cart","cartTemplate","$tr","divUpd","parent","value","hasClass","newVal","parseInt","text","changeCartQuantity","fadeIn","fadeOut","$list","eq","remove","last","append","open","html","modal","$sum","$cartSum","Promise","resolve","reject","qty","product","sum","price"],"mappings":"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","sourcesContent":["jQuery(document).ready(function($) {\n\n    $(\".scroll\").click(function(event){\n        event.preventDefault();\n        $('html,body').animate({scrollTop:$(this.hash).offset().top},1000);\n    });\n\n    const navoffeset=$(\".agileits_header\").offset().top;\n    $(window).scroll(function(){\n        var scrollpos=$(window).scrollTop();\n        if(scrollpos >=navoffeset){\n            $(\".agileits_header\").addClass(\"fixed\");\n        }else{\n            $(\".agileits_header\").removeClass(\"fixed\");\n        }\n    });\n\n    $(\".dropdown\").hover(\n        function() {\n            $('.dropdown-menu', this).stop( true, true ).slideDown(\"fast\");\n            $(this).toggleClass('open');\n        },\n        function() {\n            $('.dropdown-menu', this).stop( true, true ).slideUp(\"fast\");\n            $(this).toggleClass('open');\n        }\n    );\n\n    $().UItoTop({ easingType: 'easeOutQuart' });\n\n    $('.flexslider').flexslider({\n        animation: \"slide\",\n        start: function(slider){\n            $('body').removeClass('loading');\n        }\n    });\n\n    $('#example').okzoom({\n        width: 150,\n        height: 150,\n        border: \"1px solid black\",\n        shadow: \"0 0 5px #000\"\n    });\n\n    $('.add-to-cart').on('click', function(e) {\n        e.preventDefault();\n        const id = +$(this).data('id');\n        \n        if(id > 0) {\n\n            $.ajax({\n                url: 'cart/add',\n                data: {id}\n            })\n            .done(function (res) {\n                if(!res) alert('Произошла ошибка. Попробуйте еще раз');\n\n                updateCartDialog(res, true);\n            })\n            .fail(function (error) {\n                let res = {\n                    'error': 'Произошла ошибка. Попробуйте еще раз'\n                }\n                console.log(res);\n            });\n        }\n    });\n\n    const $modal = $('#w0');\n\n    $modal.find('.modal-body')\n    .on('click', '.del-item', function () {\n        const id = +$(this).data('id');\n        const index = +$(this).closest('tr').index();\n        \n        if(id > 0) {\n            deleteItem(id)\n            .then(res => {\n               \n                if($('.cart-table').length){\n                    console.log(res);\n                    removeUtemFromTable(res, index)\n                }\n            })\n         }\n    });\n    \n    $('#clearCart').on('click', function (e) {\n        e.preventDefault();\n        $.ajax({\n            url: 'cart/clear-cart'\n        })\n        .done(function (res) {\n            updateCartDialog('');\n\n            if($('.cart-table').length){\n                removeUtemFromTable({\n                    cart: {},\n                    cartTemplate: res\n                })\n            }\n        })\n        .fail(function (error) {\n            let res = {\n                'error': 'Произошла ошибка. Попробуйте еще раз'\n            }\n            console.log(res);\n        });\n    });\n\n    $('.value-plus, .value-minus').on('click', function(){\n        const $tr = $(this).closest(\"tr\");\n        const index = $tr.index();\n        const id = +$tr.data('id');\n        const divUpd = $(this).parent().find('.value');\n        \n        const value = $(this).hasClass('value-plus') ? 1 : -1;\n\n        const newVal = parseInt(divUpd.text(), 10)+value;\n\n        if(newVal>0) {\n            changeCartQuantity(id, value, index)\n            .then(data => {\n                divUpd.text(newVal);\n            })\n        }\n        \n    });\n\n    $('.removeItem').on('click', function(e){\n        e.preventDefault();\n\n        const $tr = $(this).closest(\"tr\");\n        const id = +$tr.data('id');\n        const index = $tr.index();\n\n        if(id > 0) {\n            $('.overlay').fadeIn();\n\n            deleteItem(id)\n            .then(res => {\n                removeUtemFromTable(res, index);\n            })\n            .catch(error => {\n                console.log(error)\n                $('.overlay').fadeOut();\n            })\n        }\n    });\n\n});\n\nfunction removeUtemFromTable(res, index) {\n\n    const {cart, cartTemplate } = res;\n    console.log(cart);\n    console.log(index);\n    if(cart['cart-sum'] > 0){\n        const $list = $('.total-list');\n\n        $('.timetable_sub tbody tr').eq(index)\n        .fadeOut('slow').remove();\n        \n        $list.find('li')\n        .last().find('span').text(cart['cart-sum']);\n\n        $list.find('li').eq(index)\n        .fadeOut('slow').remove()\n\n        $('.overlay').fadeOut();\n    }else{\n        $('.checkout-right').fadeOut();\n        $('.checkout-left').fadeOut();\n        $('.privacy.about').append(cartTemplate)\n    }\n}\n\nfunction updateCartDialog(cart, open) {\n\n    const $modal = $('#w0');\n    $modal.find('.modal-body').html(cart);\n\n    if(open){\n        $modal.modal();\n    }\n    \n    const $sum = $('#cart-sum').text();\n    const $cartSum = $sum ? $sum : '$0';\n\n    $('.cart-sum').text($cartSum);\n}\n\nfunction deleteItem(id) {\n    return new Promise((resolve, reject) => {\n\n        $.ajax({\n            url: 'cart/remove-item',\n            data: {id}\n        })\n        .done(function (res) {\n            if(!res) alert('Произошла ошибка. Попробуйте еще раз');\n\n            updateCartDialog(res.cartTemplate);\n            resolve(res)\n        })\n        .fail(function (error) {\n            reject(error)\n        });\n    });\n}\n\nfunction changeCartQuantity(id, qty, index) {\n    \n    return new Promise((resolve, reject) => {\n        \n        $.ajax({\n            url: 'cart/change-cart',\n            data: {id, qty}\n        })\n        .done(function (res) {\n            if(!res) alert('Произошла ошибка. Попробуйте еще раз');\n\n            const {cart, cartTemplate, product } = res;\n\n            const sum = product.price*product.qty;\n            const $list = $('.total-list');\n            $list.find('li').eq(index).find('span').text(`$${sum}`)\n\n            // total sum\n            $list.find('li')\n                .last().find('span').text(`$${cart['cart-sum']}`);\n\n            updateCartDialog(cartTemplate);\n\n            resolve(cart)\n        })\n        .fail(function (error) {\n            reject(error)\n        });\n    });\n}\n\n\n"],"file":"main.js"}